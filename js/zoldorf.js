var lastclicked,itemlist=json,soulitems=[],credititems=[],CREDITS=creditplaceholder,waitforresponse=0;function byond(){url="?src="+srcRef,currentIsKey=!0;for(var t=0;t<arguments.length;t++)currentIsKey?url+=";":url+="=",url+=arguments[t],currentIsKey=!currentIsKey;console.log(url);const e=new XMLHttpRequest;e.open("GET",url),e.send()}function updatecredits(t,e,s,o,c){if("add"==t)CREDITS+=parseInt(o);else if("rem"==t)o.toString().includes("%")||(CREDITS-=parseInt(o)),"i"!=lastclicked.dataset.stock&&(lastclicked.dataset.stock=(parseInt(lastclicked.dataset.stock)-1).toString(),"A"==lastclicked.tagName?(0==parseInt(lastclicked.dataset.stock)&&(lastclicked.textContent="--Out of Stock--"),lastclicked.parentElement.getElementsByTagName("P")[0].dataset.stock=lastclicked.dataset.stock.toString()):"P"==lastclicked.tagName&&(lastclicked.parentElement.getElementsByTagName("A")[0].dataset.stock=lastclicked.dataset.stock.toString()));else if("update"==t&&(o.toString().includes("%")||(CREDITS=parseInt(o)),null!=c))for(var a=document.getElementsByTagName("A"),n=0;n<a.length;n++){var l=a[n];null!=l.dataset.path&&l.dataset.path==s&&(l.dataset.stock=c.toString(),0==parseInt(l.dataset.stock)&&(l.textContent="--Out of Stock--"),l.parentElement.getElementsByTagName("P")[0].dataset.stock=c.toString())}document.getElementById("creditreturn").textContent="Return Credits: "+CREDITS.toString(),waitforresponse=0}function serverconfirm(t,e){"return"==t?updatecredits("update",null,null,0):"spawn"==t&&updatecredits("rem",null,null,e,null)}String.prototype.includes=function(t){var e=!1;return e=-1!==this.indexOf(t)?!0:e};var boop=function(t){var e,s;t.preventDefault(),waitforresponse=1,lastclicked=t.srcElement,"creditreturn"==t.srcElement.id?byond("command","return","credits",CREDITS):(e=t.srcElement.dataset.path,s=t.srcElement.dataset.cost,t=t.srcElement.dataset.stock,s.includes("%")?byond("command","soulspawn","path",e,"cost",s,"stock",t):s<=CREDITS&&byond("command","spawn","path",e,"cost",s,"stock",t))};function windowclose(){byond("command","close")}window.onload=function(t){for(var e=0;e<itemlist.length;e++)(itemlist[e].cost.includes("%")?soulitems:credititems).push(itemlist[e]);for(var s=document.getElementById("soulitems"),o=1,e=0;e<soulitems.length;e++){var c=document.createElement("div"),a=document.createElement("a"),n=document.createElement("p");o=1==o?(c.className="link sitemcolor1",n.className="soulcolor1",2):(c.className="link sitemcolor2",n.className="soulcolor2",1),0==parseInt(soulitems[e].stock)?a.textContent="--Out of Stock--":a.textContent=soulitems[e].name,a.dataset.path=soulitems[e].path,a.dataset.cost=soulitems[e].cost,a.onclick=boop,n.textContent=soulitems[e].cost,n.dataset.path=soulitems[e].path,n.dataset.cost=soulitems[e].cost,n.onclick=boop,null!=soulitems[e].stock&&(a.dataset.stock=soulitems[e].stock,n.dataset.stock=soulitems[e].stock),c.appendChild(a),c.appendChild(n),s.appendChild(c)}o=1;for(var l=document.getElementById("credititems"),o=1,e=0;e<credititems.length;e++){c=document.createElement("div"),a=document.createElement("a"),n=document.createElement("p");o=1==o?(c.className="link citemcolor1",n.className="creditcolor1",2):(c.className="link citemcolor2",n.className="creditcolor2",1),0==parseInt(credititems[e].stock)?a.textContent="--Out of Stock--":a.textContent=credititems[e].name,a.dataset.path=credititems[e].path,a.dataset.cost=credititems[e].cost,a.onclick=boop,n.textContent=credititems[e].cost+"c",n.dataset.path=credititems[e].path,n.dataset.cost=credititems[e].cost,n.onclick=boop,null!=credititems[e].stock&&(a.dataset.stock=credititems[e].stock,n.dataset.stock=credititems[e].stock),c.appendChild(a),c.appendChild(n),l.appendChild(c)}var i=document.getElementById("creditreturn");i.textContent="Return Credits: "+CREDITS.toString(),i.onclick=boop},window.onbeforeunload=windowclose;